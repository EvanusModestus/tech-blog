<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="description" content="How we transformed manual network management into a GitOps workflow managing 500+ devices with Terraform and Ansible">
<meta name="keywords" content="Terraform, Ansible, Infrastructure as Code, Network Automation, GitOps, CI/CD">
<meta name="author" content="Evan Rosado">
<title>Infrastructure as Code: Managing 500+ Network Devices with Terraform and Ansible</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Infrastructure as Code: Managing 500+ Network Devices with Terraform and Ansible</h1>
<div class="details">
<span id="author" class="author">Evan Rosado</span><br>
<span id="email" class="email"><a href="mailto:evan.rosado@outlook.com">evan.rosado@outlook.com</a></span><br>
<span id="revdate">2025-01-20</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_the_breaking_point">The Breaking Point</a></li>
<li><a href="#_architecture_overview">Architecture Overview</a>
<ul class="sectlevel2">
<li><a href="#_technology_stack">Technology Stack</a></li>
<li><a href="#_workflow_architecture">Workflow Architecture</a></li>
</ul>
</li>
<li><a href="#_terraform_infrastructure_state_management">Terraform: Infrastructure State Management</a>
<ul class="sectlevel2">
<li><a href="#_provider_configuration">Provider Configuration</a></li>
<li><a href="#_network_device_management">Network Device Management</a></li>
<li><a href="#_vlan_management">VLAN Management</a></li>
<li><a href="#_load_balancer_configuration">Load Balancer Configuration</a></li>
</ul>
</li>
<li><a href="#_ansible_configuration_deployment">Ansible: Configuration Deployment</a>
<ul class="sectlevel2">
<li><a href="#_dynamic_inventory">Dynamic Inventory</a></li>
<li><a href="#_switch_configuration_playbook">Switch Configuration Playbook</a></li>
<li><a href="#_configuration_templates">Configuration Templates</a></li>
</ul>
</li>
<li><a href="#_cicd_pipeline">CI/CD Pipeline</a>
<ul class="sectlevel2">
<li><a href="#_gitlab_ci_configuration">GitLab CI Configuration</a></li>
<li><a href="#_testing_framework">Testing Framework</a></li>
</ul>
</li>
<li><a href="#_monitoring_and_observability">Monitoring and Observability</a>
<ul class="sectlevel2">
<li><a href="#_prometheus_metrics">Prometheus Metrics</a></li>
</ul>
</li>
<li><a href="#_results_and_metrics">Results and Metrics</a></li>
<li><a href="#_lessons_learned">Lessons Learned</a>
<ul class="sectlevel2">
<li><a href="#_what_worked">What Worked</a></li>
<li><a href="#_challenges_overcome">Challenges Overcome</a></li>
</ul>
</li>
<li><a href="#_future_enhancements">Future Enhancements</a></li>
<li><a href="#_conclusion">Conclusion</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>Managing 500+ network devices manually is a recipe for disaster. After implementing Infrastructure as Code principles using Terraform for state management and Ansible for configuration deployment, our network changes went from error-prone marathons to reviewed, tested, and automated deployments. This is how we did it.</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_breaking_point">The Breaking Point</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In 2022, our network had grown to:
* 300+ switches across 15 locations
* 150+ wireless access points
* 50+ routers and firewalls
* 30+ load balancers</p>
</div>
<div class="paragraph">
<p>A typical change request took 4-6 hours and involved manually configuring devices through CLI sessions. Our breaking point came during a VLAN rollout that should have taken 2 hours but stretched to 14 hours due to human errors and inconsistencies.</p>
</div>
<div class="paragraph">
<p>That weekend, I started building what would become our Infrastructure as Code platform.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture_overview">Architecture Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_technology_stack">Technology Stack</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml">infrastructure_stack:
  state_management:
    tool: Terraform
    version: 1.6.x
    backend: S3 with DynamoDB locking

  configuration_management:
    tool: Ansible
    version: 2.16.x
    inventory: Dynamic from Netbox

  source_control:
    platform: GitLab
    branching: GitFlow

  ci_cd:
    pipeline: GitLab CI
    stages: [validate, plan, test, deploy]

  monitoring:
    observability: Prometheus + Grafana
    logging: ELK Stack
    alerting: PagerDuty

  documentation:
    api_docs: OpenAPI/Swagger
    runbooks: Confluence
    diagrams: Diagrams as Code (Python)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_workflow_architecture">Workflow Architecture</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="asciidoc">Developer → Git Push → CI Pipeline → Terraform Plan → Review → Apply → Ansible Deploy
     ↑                                                                            ↓
     └──────────────────────── Monitoring &amp; Rollback ←──────────────────────────┘</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_terraform_infrastructure_state_management">Terraform: Infrastructure State Management</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_provider_configuration">Provider Configuration</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="hcl"># terraform/providers.tf - Multi-vendor provider setup
terraform {
  required_version = "&gt;= 1.6.0"

  required_providers {
    cisco = {
      source  = "CiscoDevNet/cisco"
      version = "~&gt; 0.8.0"
    }

    fortios = {
      source  = "fortinetdev/fortios"
      version = "~&gt; 1.18.0"
    }

    panos = {
      source  = "PaloAltoNetworks/panos"
      version = "~&gt; 1.11.0"
    }

    netbox = {
      source  = "e-breuninger/netbox"
      version = "~&gt; 3.7.0"
    }

    vault = {
      source  = "hashicorp/vault"
      version = "~&gt; 3.23.0"
    }
  }

  backend "s3" {
    bucket         = "network-terraform-state"
    key            = "production/terraform.tfstate"
    region         = "us-east-1"
    encrypt        = true
    dynamodb_table = "terraform-state-lock"
  }
}

# Provider configurations with credential management
provider "cisco" {
  alias = "ise"

  host     = var.ise_host
  username = data.vault_generic_secret.cisco.data["username"]
  password = data.vault_generic_secret.cisco.data["password"]
}

provider "netbox" {
  server_url = var.netbox_url
  api_token  = data.vault_generic_secret.netbox.data["token"]
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_network_device_management">Network Device Management</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="hcl"># terraform/modules/network_device/main.tf
resource "netbox_device" "switch" {
  for_each = var.switches

  name            = each.key
  device_type_id  = data.netbox_device_type.catalyst_9300.id
  role_id        = data.netbox_device_role.access_switch.id
  site_id        = data.netbox_site.site[each.value.location].id
  status         = "active"

  primary_ip4 = netbox_ip_address.management[each.key].id

  custom_fields = {
    automation_enabled = true
    configuration_template = each.value.template
    vlan_range = each.value.vlan_range
  }

  tags = [
    "terraform-managed",
    "production",
    each.value.location
  ]
}

resource "netbox_ip_address" "management" {
  for_each = var.switches

  ip_address = each.value.management_ip
  status     = "active"
  role       = "management"

  object_type = "dcim.interface"
  object_id   = netbox_interface.management[each.key].id

  tags = ["management", "terraform"]
}

resource "netbox_interface" "management" {
  for_each = var.switches

  device_id = netbox_device.switch[each.key].id
  name      = "Management1"
  type      = "1000base-t"
  enabled   = true
  mode      = "access"

  tags = ["management"]
}

# Generate Ansible inventory from Netbox
resource "local_file" "ansible_inventory" {
  filename = "../ansible/inventory/dynamic_hosts.yml"

  content = yamlencode({
    all = {
      children = {
        switches = {
          hosts = {
            for name, device in netbox_device.switch :
            name =&gt; {
              ansible_host = device.primary_ip4
              site         = device.site_id
              role         = device.role_id
              template     = device.custom_fields.configuration_template
            }
          }
        }
      }
    }
  })
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vlan_management">VLAN Management</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="hcl"># terraform/modules/vlan/main.tf
variable "vlans" {
  description = "VLAN definitions"
  type = map(object({
    id          = number
    name        = string
    description = string
    site        = string
    subnet      = string
    gateway     = string
  }))
}

resource "netbox_vlan" "vlan" {
  for_each = var.vlans

  vid         = each.value.id
  name        = each.value.name
  description = each.value.description
  site_id     = data.netbox_site.site[each.value.site].id
  status      = "active"

  tags = ["terraform", "production"]
}

resource "netbox_prefix" "subnet" {
  for_each = var.vlans

  prefix      = each.value.subnet
  vlan_id     = netbox_vlan.vlan[each.key].id
  site_id     = data.netbox_site.site[each.value.site].id
  status      = "active"
  is_pool     = false

  description = "VLAN ${each.value.id} - ${each.value.name}"

  tags = ["terraform", "production"]
}

resource "netbox_ip_address" "gateway" {
  for_each = var.vlans

  ip_address  = each.value.gateway
  status      = "active"
  role        = "anycast"
  description = "Gateway for VLAN ${each.value.id}"

  object_type = "ipam.vlan"
  object_id   = netbox_vlan.vlan[each.key].id

  tags = ["gateway", "terraform"]
}

# Output for Ansible consumption
output "vlan_configuration" {
  value = {
    for key, vlan in var.vlans : key =&gt; {
      id      = vlan.id
      name    = vlan.name
      subnet  = vlan.subnet
      gateway = vlan.gateway
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_load_balancer_configuration">Load Balancer Configuration</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="hcl"># terraform/modules/f5/main.tf
resource "bigip_ltm_pool" "web_pool" {
  name                = "/Common/web_pool_${var.environment}"
  load_balancing_mode = "round-robin"
  monitors            = ["/Common/http"]
  allow_snat          = "yes"
  allow_nat           = "yes"
}

resource "bigip_ltm_pool_attachment" "web_servers" {
  for_each = var.web_servers

  pool               = bigip_ltm_pool.web_pool.name
  node               = each.value.ip
  port               = each.value.port
  connection_limit   = 100
  connection_rate_limit = 100
  dynamic_ratio      = 1
  priority_group     = each.value.priority
}

resource "bigip_ltm_virtual_server" "web_vs" {
  name        = "/Common/vs_web_${var.environment}"
  port        = 443
  destination = var.vip_address
  pool        = bigip_ltm_pool.web_pool.name

  ip_protocol             = "tcp"
  source_address_translation = "automap"

  profiles = [
    "/Common/tcp",
    "/Common/http",
    bigip_ltm_profile_client_ssl.web_ssl.name
  ]

  persistence_profiles = [
    "/Common/cookie"
  ]

  irules = [
    bigip_ltm_irule.security_headers.name
  ]
}

resource "bigip_ltm_irule" "security_headers" {
  name  = "/Common/security_headers_${var.environment}"
  irule = file("${path.module}/irules/security_headers.tcl")
}

resource "bigip_ltm_profile_client_ssl" "web_ssl" {
  name          = "/Common/clientssl_web_${var.environment}"
  cert          = "/Common/web_cert.crt"
  key           = "/Common/web_key.key"
  chain         = "/Common/intermediate.crt"
  ciphers       = "TLS13:TLS12+HIGH:!RSA:!aNULL:!eNULL:!3DES"

  server_name = var.domain_name
  sni_require = true
  sni_default = true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ansible_configuration_deployment">Ansible: Configuration Deployment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_dynamic_inventory">Dynamic Inventory</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python">#!/usr/bin/env python3
# ansible/inventory/netbox_inventory.py - Dynamic inventory from Netbox
import json
import requests
from typing import Dict, List

class NetboxInventory:
    """Generate Ansible inventory from Netbox"""

    def __init__(self):
        self.netbox_url = os.getenv("NETBOX_URL")
        self.netbox_token = os.getenv("NETBOX_TOKEN")
        self.inventory = {
            "_meta": {"hostvars": {}},
            "all": {"children": ["ungrouped"]}
        }

    def get_devices(self) -&gt; List[Dict]:
        """Fetch devices from Netbox"""
        headers = {"Authorization": f"Token {self.netbox_token}"}
        response = requests.get(
            f"{self.netbox_url}/api/dcim/devices/",
            headers=headers,
            params={"status": "active", "has_primary_ip": "true"}
        )
        return response.json()["results"]

    def build_inventory(self):
        """Build Ansible inventory structure"""
        devices = self.get_devices()

        for device in devices:
            # Skip non-network devices
            if not device.get("custom_fields", {}).get("automation_enabled"):
                continue

            hostname = device["name"]
            ip = device["primary_ip"]["address"].split('/')[0]

            # Device-specific variables
            self.inventory["_meta"]["hostvars"][hostname] = {
                "ansible_host": ip,
                "ansible_network_os": self._get_network_os(device),
                "ansible_connection": "network_cli",
                "device_role": device["device_role"]["slug"],
                "site": device["site"]["slug"],
                "platform": device["platform"]["slug"] if device.get("platform") else None,
                "configuration_template": device["custom_fields"].get("configuration_template"),
                "vlans": self._get_vlans(device),
            }

            # Group by device role
            role = device["device_role"]["slug"]
            if role not in self.inventory:
                self.inventory[role] = {"hosts": []}
            self.inventory[role]["hosts"].append(hostname)

            # Group by site
            site = f"site_{device['site']['slug']}"
            if site not in self.inventory:
                self.inventory[site] = {"hosts": []}
            self.inventory[site]["hosts"].append(hostname)

    def _get_network_os(self, device: Dict) -&gt; str:
        """Determine network OS from platform"""
        platform = device.get("platform", {}).get("slug", "")

        os_mapping = {
            "cisco-ios": "ios",
            "cisco-nxos": "nxos",
            "cisco-iosxe": "iosxe",
            "arista-eos": "eos",
            "juniper-junos": "junos",
            "paloalto-panos": "panos"
        }

        return os_mapping.get(platform, "ios")

    def _get_vlans(self, device: Dict) -&gt; List[Dict]:
        """Get VLANs assigned to device"""
        headers = {"Authorization": f"Token {self.netbox_token}"}
        response = requests.get(
            f"{self.netbox_url}/api/ipam/vlans/",
            headers=headers,
            params={"site_id": device["site"]["id"]}
        )

        vlans = []
        for vlan in response.json()["results"]:
            vlans.append({
                "id": vlan["vid"],
                "name": vlan["name"],
                "description": vlan["description"]
            })

        return vlans

    def generate(self) -&gt; str:
        """Generate inventory JSON"""
        self.build_inventory()
        return json.dumps(self.inventory, indent=2)

if __name__ == "__main__":
    inventory = NetboxInventory()
    print(inventory.generate())</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_switch_configuration_playbook">Switch Configuration Playbook</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"># ansible/playbooks/configure_switches.yml
---
- name: Configure Access Switches
  hosts: access_switch
  gather_facts: no

  vars:
    configuration_backup_dir: "{{ playbook_dir }}/../backups"

  pre_tasks:
    - name: Create backup directory
      delegate_to: localhost
      file:
        path: "{{ configuration_backup_dir }}"
        state: directory
        mode: '0755'

    - name: Backup current configuration
      cisco.ios.ios_config:
        backup: yes
        backup_options:
          filename: "{{ inventory_hostname }}_{{ ansible_date_time.date }}.cfg"
          dir_path: "{{ configuration_backup_dir }}"
      register: backup_result

  tasks:
    - name: Configure hostname and domain
      cisco.ios.ios_system:
        hostname: "{{ inventory_hostname }}"
        domain_name: "{{ domain_name }}"
        lookup_enabled: no

    - name: Configure management interface
      cisco.ios.ios_l3_interface:
        name: "{{ management_interface | default('Vlan99') }}"
        ipv4: "{{ ansible_host }}/{{ management_netmask }}"

    - name: Configure NTP servers
      cisco.ios.ios_ntp:
        server: "{{ item }}"
        source_int: "{{ management_interface | default('Vlan99') }}"
        logging: true
      loop: "{{ ntp_servers }}"

    - name: Configure TACACS+ servers
      cisco.ios.ios_aaa_server:
        name: "{{ item.name }}"
        server_type: tacacs+
        address: "{{ item.address }}"
        key: "{{ tacacs_key }}"
        timeout: 5
      loop: "{{ tacacs_servers }}"
      no_log: true

    - name: Configure AAA
      cisco.ios.ios_config:
        lines:
          - aaa new-model
          - aaa authentication login default group tacacs+ local
          - aaa authorization exec default group tacacs+ local
          - aaa accounting exec default start-stop group tacacs+
          - aaa accounting commands 15 default start-stop group tacacs+

    - name: Configure VLANs
      cisco.ios.ios_vlans:
        config:
          - vlan_id: "{{ item.id }}"
            name: "{{ item.name }}"
            state: active
      loop: "{{ vlans }}"

    - name: Configure trunk ports
      cisco.ios.ios_l2_interface:
        name: "{{ item.interface }}"
        mode: trunk
        native_vlan: "{{ native_vlan | default(1) }}"
        trunk_allowed_vlans: "{{ item.allowed_vlans | default('all') }}"
      loop: "{{ trunk_ports }}"
      when: trunk_ports is defined

    - name: Configure access ports
      cisco.ios.ios_l2_interface:
        name: "{{ item.interface }}"
        mode: access
        access_vlan: "{{ item.vlan }}"
      loop: "{{ access_ports }}"
      when: access_ports is defined

    - name: Configure spanning-tree
      cisco.ios.ios_config:
        lines:
          - spanning-tree mode rapid-pvst
          - spanning-tree portfast edge default
          - spanning-tree portfast edge bpduguard default
          - spanning-tree vlan 1-4094 priority "{{ stp_priority | default(32768) }}"

    - name: Configure SNMP
      cisco.ios.ios_snmp_server:
        config:
          communities:
            - name: "{{ snmp_ro_community }}"
              ro: true
          hosts:
            - host: "{{ item }}"
              community: "{{ snmp_ro_community }}"
              version: "2c"
              traps: true
      loop: "{{ snmp_servers }}"
      no_log: true

    - name: Configure logging
      cisco.ios.ios_logging:
        dest: host
        name: "{{ item }}"
        level: informational
        facility: local7
      loop: "{{ syslog_servers }}"

    - name: Apply security hardening
      cisco.ios.ios_config:
        src: templates/security_hardening.j2
      notify: save_configuration

    - name: Verify configuration
      cisco.ios.ios_command:
        commands:
          - show vlan brief
          - show interfaces status
          - show spanning-tree summary
          - show logging
      register: verification

    - name: Generate compliance report
      template:
        src: compliance_report.j2
        dest: "{{ playbook_dir }}/../reports/{{ inventory_hostname }}_compliance.txt"
      delegate_to: localhost

  handlers:
    - name: save_configuration
      cisco.ios.ios_config:
        save_when: modified

  post_tasks:
    - name: Validate configuration
      include_tasks: validate_switch.yml

    - name: Send notification
      mail:
        to: "{{ notification_email }}"
        subject: "Switch Configuration Complete - {{ inventory_hostname }}"
        body: |
          Switch configuration completed successfully.

          Device: {{ inventory_hostname }}
          IP: {{ ansible_host }}
          Site: {{ site }}
          Backup: {{ backup_result.backup_path }}

          VLANs configured: {{ vlans | length }}
          Trunk ports: {{ trunk_ports | default([]) | length }}
          Access ports: {{ access_ports | default([]) | length }}
      delegate_to: localhost
      when: notification_email is defined</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_templates">Configuration Templates</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="jinja2">{# templates/security_hardening.j2 - Security baseline configuration #}
! Security Hardening Configuration
! Generated: {{ ansible_date_time.iso8601 }}

! Disable unused services
no service pad
no service finger
no service udp-small-servers
no service tcp-small-servers
no ip bootp server
no ip domain-lookup
no ip http server
no ip http secure-server

! Enable useful services
service tcp-keepalives-in
service tcp-keepalives-out
service timestamps debug datetime msec localtime show-timezone
service timestamps log datetime msec localtime show-timezone
service password-encryption
service compress-config

! Console and VTY hardening
line console 0
 exec-timeout 5 0
 logging synchronous
 transport output none

line vty 0 15
 exec-timeout 5 0
 logging synchronous
 transport input ssh
 transport output ssh
 access-class ACL_SSH_ACCESS in

! SSH Configuration
ip ssh version 2
ip ssh time-out 60
ip ssh authentication-retries 3
ip ssh source-interface {{ management_interface | default('Vlan99') }}
crypto key generate rsa modulus 4096

! Login banner
banner login ^C
===============================================================================
         UNAUTHORIZED ACCESS TO THIS DEVICE IS PROHIBITED

This is a private system. Unauthorized access, use, or modification
of this system is strictly prohibited. All access and activity are
logged and monitored. Violators will be prosecuted to the fullest
extent of the law.

Device: $(hostname)
Location: {{ site }}
===============================================================================
^C

! DHCP Snooping (access switches)
{% if device_role == 'access_switch' %}
ip dhcp snooping
ip dhcp snooping vlan {{ vlans | map(attribute='id') | join(',') }}
ip arp inspection vlan {{ vlans | map(attribute='id') | join(',') }}
ip verify source

! Loop prevention
spanning-tree loopguard default
udld aggressive
{% endif %}

! Control plane protection
control-plane
 service-policy input CONTROL_PLANE_POLICY

! Access lists
ip access-list standard ACL_SSH_ACCESS
 permit {{ management_network }} {{ management_wildcard }}
 deny any log

! Infrastructure ACLs
ip access-list extended ACL_INFRASTRUCTURE
 permit tcp {{ management_network }} {{ management_wildcard }} any eq 22
 permit tcp {{ management_network }} {{ management_wildcard }} any eq 23
 permit udp any any eq 161
 permit udp any eq 123 any
 permit udp any any eq 514
 deny ip any any log

! Logging configuration
logging buffered 65536 informational
logging trap informational
logging source-interface {{ management_interface | default('Vlan99') }}
{% for server in syslog_servers %}
logging host {{ server }}
{% endfor %}

! Archive configuration
archive
 path flash:archive-config
 write-memory
 time-period 1440

! End of security hardening</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cicd_pipeline">CI/CD Pipeline</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gitlab_ci_configuration">GitLab CI Configuration</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"># .gitlab-ci.yml - Network automation pipeline
stages:
  - validate
  - plan
  - test
  - deploy
  - verify

variables:
  TF_ROOT: ${CI_PROJECT_DIR}/terraform
  ANSIBLE_ROOT: ${CI_PROJECT_DIR}/ansible

before_script:
  - export VAULT_ADDR=${VAULT_ADDR}
  - export VAULT_TOKEN=${VAULT_TOKEN}
  - export NETBOX_URL=${NETBOX_URL}
  - export NETBOX_TOKEN=${NETBOX_TOKEN}

# Validation Stage
terraform-validate:
  stage: validate
  image: hashicorp/terraform:1.6
  script:
    - cd ${TF_ROOT}
    - terraform init -backend=false
    - terraform validate
    - terraform fmt -check=true -diff=true
  rules:
    - if: '$CI_MERGE_REQUEST_ID'

ansible-lint:
  stage: validate
  image: quay.io/ansible/creator-ee:latest
  script:
    - cd ${ANSIBLE_ROOT}
    - ansible-lint playbooks/
    - ansible-playbook playbooks/*.yml --syntax-check
  rules:
    - if: '$CI_MERGE_REQUEST_ID'

yaml-lint:
  stage: validate
  image: python:3.11
  script:
    - pip install yamllint
    - yamllint -c .yamllint ${ANSIBLE_ROOT}
  rules:
    - if: '$CI_MERGE_REQUEST_ID'

# Planning Stage
terraform-plan:
  stage: plan
  image: hashicorp/terraform:1.6
  script:
    - cd ${TF_ROOT}
    - terraform init
    - terraform plan -out=tfplan
    - terraform show -no-color tfplan &gt; plan.txt
  artifacts:
    paths:
      - ${TF_ROOT}/tfplan
      - ${TF_ROOT}/plan.txt
    expire_in: 7 days
  rules:
    - if: '$CI_MERGE_REQUEST_ID'

review-plan:
  stage: plan
  image: alpine:latest
  dependencies:
    - terraform-plan
  script:
    - cat ${TF_ROOT}/plan.txt
    # Post plan to merge request as comment
    - |
      curl -X POST "${CI_API_V4_URL}/projects/${CI_PROJECT_ID}/merge_requests/${CI_MERGE_REQUEST_IID}/notes" \
        -H "PRIVATE-TOKEN: ${GITLAB_TOKEN}" \
        -H "Content-Type: application/json" \
        -d "{\"body\": \"## Terraform Plan\n\`\`\`\n$(cat ${TF_ROOT}/plan.txt)\n\`\`\`\"}"
  rules:
    - if: '$CI_MERGE_REQUEST_ID'

# Test Stage
test-inventory:
  stage: test
  image: quay.io/ansible/creator-ee:latest
  script:
    - cd ${ANSIBLE_ROOT}
    - python inventory/netbox_inventory.py --list &gt; inventory.json
    - ansible-inventory -i inventory/netbox_inventory.py --list
    - ansible-inventory -i inventory/netbox_inventory.py --graph
  artifacts:
    paths:
      - ${ANSIBLE_ROOT}/inventory.json
    expire_in: 1 day
  rules:
    - if: '$CI_MERGE_REQUEST_ID'

dry-run:
  stage: test
  image: quay.io/ansible/creator-ee:latest
  script:
    - cd ${ANSIBLE_ROOT}
    - ansible-playbook playbooks/configure_switches.yml --check --diff
  rules:
    - if: '$CI_MERGE_REQUEST_ID'
  when: manual

# Deploy Stage
terraform-apply:
  stage: deploy
  image: hashicorp/terraform:1.6
  script:
    - cd ${TF_ROOT}
    - terraform init
    - terraform apply tfplan
  dependencies:
    - terraform-plan
  rules:
    - if: '$CI_COMMIT_BRANCH == "main"'
  when: manual
  environment:
    name: production
    url: https://netbox.company.com

ansible-deploy:
  stage: deploy
  image: quay.io/ansible/creator-ee:latest
  script:
    - cd ${ANSIBLE_ROOT}
    - ansible-playbook playbooks/configure_switches.yml -v
  rules:
    - if: '$CI_COMMIT_BRANCH == "main"'
  when: manual
  environment:
    name: production

# Verification Stage
verify-deployment:
  stage: verify
  image: python:3.11
  script:
    - pip install requests pytest pytest-html
    - cd ${CI_PROJECT_DIR}/tests
    - pytest test_network.py --html=report.html --self-contained-html
  artifacts:
    paths:
      - tests/report.html
    reports:
      junit: tests/report.xml
    expire_in: 30 days
  rules:
    - if: '$CI_COMMIT_BRANCH == "main"'

compliance-check:
  stage: verify
  image: quay.io/ansible/creator-ee:latest
  script:
    - cd ${ANSIBLE_ROOT}
    - ansible-playbook playbooks/compliance_check.yml
    - python scripts/generate_compliance_report.py
  artifacts:
    paths:
      - ${ANSIBLE_ROOT}/reports/
    expire_in: 30 days
  rules:
    - if: '$CI_COMMIT_BRANCH == "main"'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_framework">Testing Framework</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"># tests/test_network.py - Network validation tests
import pytest
import requests
from netmiko import ConnectHandler
from typing import Dict, List

class TestNetworkDeployment:
    """Validate network configuration deployment"""

    @pytest.fixture(scope="module")
    def devices(self) -&gt; List[Dict]:
        """Get device list from Netbox"""
        response = requests.get(
            f"{os.getenv('NETBOX_URL')}/api/dcim/devices/",
            headers={"Authorization": f"Token {os.getenv('NETBOX_TOKEN')}"},
            params={"status": "active", "role": "access_switch"}
        )
        return response.json()["results"]

    def test_device_reachability(self, devices):
        """Test all devices are reachable"""
        for device in devices:
            ip = device["primary_ip"]["address"].split('/')[0]
            response = subprocess.run(
                ["ping", "-c", "3", "-W", "2", ip],
                capture_output=True
            )
            assert response.returncode == 0, f"Device {device['name']} not reachable"

    def test_ssh_connectivity(self, devices):
        """Test SSH connectivity to devices"""
        for device in devices:
            conn = ConnectHandler(
                device_type="cisco_ios",
                host=device["primary_ip"]["address"].split('/')[0],
                username=os.getenv("NETWORK_USERNAME"),
                password=os.getenv("NETWORK_PASSWORD"),
                timeout=10
            )
            output = conn.send_command("show version")
            assert "Cisco" in output, f"Unexpected output from {device['name']}"
            conn.disconnect()

    def test_vlan_configuration(self, devices):
        """Verify VLAN configuration"""
        expected_vlans = self._get_expected_vlans()

        for device in devices:
            conn = self._connect_device(device)
            output = conn.send_command("show vlan brief")

            for vlan in expected_vlans[device["site"]["slug"]]:
                assert str(vlan["id"]) in output, \
                    f"VLAN {vlan['id']} missing on {device['name']}"
                assert vlan["name"] in output, \
                    f"VLAN {vlan['name']} missing on {device['name']}"

            conn.disconnect()

    def test_ntp_synchronization(self, devices):
        """Verify NTP synchronization"""
        for device in devices:
            conn = self._connect_device(device)
            output = conn.send_command("show ntp status")

            assert "Clock is synchronized" in output, \
                f"NTP not synchronized on {device['name']}"

            conn.disconnect()

    def test_spanning_tree(self, devices):
        """Verify spanning-tree configuration"""
        for device in devices:
            conn = self._connect_device(device)
            output = conn.send_command("show spanning-tree summary")

            assert "RSTP" in output or "rapid-pvst" in output, \
                f"Rapid spanning-tree not configured on {device['name']}"

            assert "Loopguard Default" in output, \
                f"Loopguard not enabled on {device['name']}"

            conn.disconnect()

    def test_security_hardening(self, devices):
        """Verify security configurations"""
        security_checks = [
            ("show ip ssh", "SSH Enabled - version 2"),
            ("show running-config | include ^no service", "no service pad"),
            ("show archive", "Archive feature not enabled")
        ]

        for device in devices:
            conn = self._connect_device(device)

            for command, expected in security_checks:
                output = conn.send_command(command)
                assert expected in output, \
                    f"Security check failed on {device['name']}: {expected}"

            conn.disconnect()

    @pytest.mark.performance
    def test_interface_errors(self, devices):
        """Check for interface errors"""
        for device in devices:
            conn = self._connect_device(device)
            output = conn.send_command("show interfaces | include error")

            lines = output.split('\n')
            for line in lines:
                if "error" in line.lower():
                    # Parse error counts
                    parts = line.split()
                    if len(parts) &gt;= 2 and parts[0].isdigit():
                        error_count = int(parts[0])
                        assert error_count == 0, \
                            f"Interface errors detected on {device['name']}: {line}"

            conn.disconnect()

    def _connect_device(self, device: Dict) -&gt; ConnectHandler:
        """Helper to connect to device"""
        return ConnectHandler(
            device_type="cisco_ios",
            host=device["primary_ip"]["address"].split('/')[0],
            username=os.getenv("NETWORK_USERNAME"),
            password=os.getenv("NETWORK_PASSWORD")
        )

    def _get_expected_vlans(self) -&gt; Dict[str, List]:
        """Get expected VLANs from Netbox"""
        response = requests.get(
            f"{os.getenv('NETBOX_URL')}/api/ipam/vlans/",
            headers={"Authorization": f"Token {os.getenv('NETBOX_TOKEN')}"}
        )

        vlans_by_site = {}
        for vlan in response.json()["results"]:
            site = vlan["site"]["slug"]
            if site not in vlans_by_site:
                vlans_by_site[site] = []

            vlans_by_site[site].append({
                "id": vlan["vid"],
                "name": vlan["name"]
            })

        return vlans_by_site</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_and_observability">Monitoring and Observability</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_prometheus_metrics">Prometheus Metrics</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"># monitoring/network_exporter.py - Custom Prometheus exporter
from prometheus_client import start_http_server, Gauge, Counter
import time
from netmiko import ConnectHandler

# Define metrics
interface_status = Gauge('network_interface_status',
                        'Interface operational status',
                        ['device', 'interface'])

interface_traffic_in = Counter('network_interface_bytes_received',
                              'Interface bytes received',
                              ['device', 'interface'])

interface_traffic_out = Counter('network_interface_bytes_transmitted',
                               'Interface bytes transmitted',
                               ['device', 'interface'])

cpu_utilization = Gauge('network_device_cpu_percent',
                       'Device CPU utilization',
                       ['device'])

memory_utilization = Gauge('network_device_memory_percent',
                          'Device memory utilization',
                          ['device'])

config_changes = Counter('network_config_changes_total',
                        'Configuration changes detected',
                        ['device'])

def collect_metrics():
    """Collect metrics from network devices"""
    devices = get_devices_from_netbox()

    for device in devices:
        try:
            conn = connect_to_device(device)

            # Collect interface stats
            interfaces = conn.send_command("show interfaces", use_textfsm=True)
            for intf in interfaces:
                interface_status.labels(
                    device=device['name'],
                    interface=intf['interface']
                ).set(1 if intf['link_status'] == 'up' else 0)

                interface_traffic_in.labels(
                    device=device['name'],
                    interface=intf['interface']
                )._value.set(int(intf.get('input_bytes', 0)))

                interface_traffic_out.labels(
                    device=device['name'],
                    interface=intf['interface']
                )._value.set(int(intf.get('output_bytes', 0)))

            # Collect CPU/Memory
            cpu = parse_cpu_output(conn.send_command("show processes cpu"))
            cpu_utilization.labels(device=device['name']).set(cpu)

            memory = parse_memory_output(conn.send_command("show memory"))
            memory_utilization.labels(device=device['name']).set(memory)

            conn.disconnect()

        except Exception as e:
            logger.error(f"Failed to collect metrics from {device['name']}: {e}")

if __name__ == "__main__":
    start_http_server(9100)
    while True:
        collect_metrics()
        time.sleep(60)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_results_and_metrics">Results and Metrics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After 18 months of Infrastructure as Code:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric</th>
<th class="tableblock halign-left valign-top">Before IaC</th>
<th class="tableblock halign-left valign-top">After IaC</th>
<th class="tableblock halign-left valign-top">Improvement</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Average Change Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 hours</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16x faster</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change Failure Rate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.5%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">96% reduction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rollback Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 hours</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24x faster</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Drift</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">35% of devices</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% eliminated</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Audit Compliance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">78%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99.5%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">21.5% improvement</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MTTR (Config Issues)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 hours</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18x faster</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Engineer Hours/Week on Configs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60 hours</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 hours</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">92% reduction</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Documentation Accuracy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~60%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code is documentation</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_lessons_learned">Lessons Learned</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_worked">What Worked</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Start Small</strong>: We began with read-only operations, then simple changes, then complex workflows</p>
</li>
<li>
<p><strong>Version Everything</strong>: Every change tracked in Git has saved us countless times</p>
</li>
<li>
<p><strong>Test in Production-Like</strong>: Our staging environment mirrors production exactly</p>
</li>
<li>
<p><strong>Rollback First</strong>: Always implement rollback before deployment</p>
</li>
<li>
<p><strong>Monitor Everything</strong>: Observability into the automation itself is crucial</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_challenges_overcome">Challenges Overcome</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Vendor Lock-in</strong>: Multi-vendor environments require abstraction layers</p>
</li>
<li>
<p><strong>Legacy Devices</strong>: Some older devices needed custom modules</p>
</li>
<li>
<p><strong>Cultural Change</strong>: Network engineers needed time to trust automation</p>
</li>
<li>
<p><strong>Credential Management</strong>: Vault integration was essential for security</p>
</li>
<li>
<p><strong>Audit Requirements</strong>: Had to build extensive logging and approval workflows</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_future_enhancements">Future Enhancements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We&#8217;re currently working on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>AI-Powered Anomaly Detection</strong>: Using ML to predict configuration issues</p>
</li>
<li>
<p><strong>Self-Healing Networks</strong>: Automatic remediation of common issues</p>
</li>
<li>
<p><strong>Intent-Based Networking</strong>: Declaring desired state rather than configuration</p>
</li>
<li>
<p><strong>ChatOps Integration</strong>: Managing networks through Slack commands</p>
</li>
<li>
<p><strong>Predictive Capacity Planning</strong>: Using historical data for proactive scaling</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Infrastructure as Code transformed our network operations from a bottleneck to a competitive advantage. The initial investment in tooling and training paid for itself within six months through reduced outages and faster deployments.</p>
</div>
<div class="paragraph">
<p>The key insight: networks are just specialized computers running specialized software. Once you treat them as such, modern software engineering practices apply directly. Version control, testing, CI/CD, and observability aren&#8217;t optional—they&#8217;re essential for operating at scale.</p>
</div>
<div class="paragraph">
<p>For teams considering this journey: start today, start small, but start. Every manual configuration you automate is a future problem prevented.</p>
</div>
<hr>
<div class="paragraph">
<p><em>This post represents the culmination of three years building network automation at scale. The frameworks and patterns described here manage production infrastructure supporting millions of users daily.</em></p>
</div>
<div class="openblock small">
<div class="content">
<div class="paragraph">
<p><strong>About the Author</strong>: Evan Rosado manages network infrastructure as code, treating routers and switches like any other deployment target in a CI/CD pipeline. His automation framework handles 500+ network devices with the same rigor as application deployments.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-09-20 18:26:21 -0700
</div>
</div>
</body>
</html>